<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FormRepeater - Advanced Example</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .form-repeat-box-item {
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1>Advanced Task Manager</h1>
        <p class="lead">With callbacks, validation, and custom features</p>

        <div class="alert alert-info">
            <strong>Features:</strong> Custom callbacks, confirmation dialogs, auto-focus, debug mode
        </div>

        <form id="task-form">
            <!-- Template -->
            <div id="task-template" class="form-repeat-box-item" style="display: none;">
                <div class="row">
                    <div class="col-md-4">
                        <label class="form-label">Task Name</label>
                        <input type="text" class="form-control form-repeat-field-ipt" 
                               data-field-name="task" placeholder="Enter task" required>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Priority</label>
                        <select class="form-select form-repeat-field-ipt" data-field-name="priority" required>
                            <option value="">Select priority</option>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Due Date</label>
                        <input type="date" class="form-control form-repeat-field-ipt" data-field-name="due_date">
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="button" class="btn btn-danger form-repeat-delete-btn w-100">
                            Remove
                        </button>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-12">
                        <label class="form-label">Description</label>
                        <textarea class="form-control form-repeat-field-ipt" 
                                  data-field-name="description" rows="2" 
                                  placeholder="Task description..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Container -->
            <div id="tasks-list"></div>

            <!-- Add button -->
            <button type="button" 
                    class="btn btn-success btn-lg form-repeat-add-btn"
                    data-group-name="tasks"
                    data-box-default="#task-template"
                    data-box-list="#tasks-list">
                Add New Task
            </button>

            <hr class="my-4">
            <button type="submit" class="btn btn-primary btn-lg">Submit Tasks</button>
        </form>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/viettuans/form-repeater@master/public/formix.js"></script>

    <script>
        // Advanced configuration with callbacks
        const taskRepeater = new FormRepeater({
            debugMode: true,
            
            onBeforeAdd: function($button) {
                const currentTasks = $('#tasks-list .form-repeat-box-item').length;
                if (currentTasks >= 5) {
                    alert('Maximum 5 tasks allowed!');
                    return false;
                }
                return true;
            },
            
            onAfterAdd: function($newElement) {
                // Auto-focus and set default date
                $newElement.find('input:first').focus();
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                $newElement.find('input[type="date"]').val(tomorrow.toISOString().split('T')[0]);
                $newElement.hide().fadeIn(300);
            },
            
            onBeforeDelete: function($item) {
                return confirm('Remove this task?');
            },
            
            onAfterDelete: function() {
                console.log('Task removed successfully!');
            }
        });
    </script>
</body>
</html>
